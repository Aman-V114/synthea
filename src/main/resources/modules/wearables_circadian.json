{
  "name": "Wearables_Circadian",
  "remarks": [
    "The regulation of sleep is processed by the homeostatic physiology of the circadian rhythm, the sleep/wake cycle. Circadian rhythm is the 24-hour internal clock in our brain that regulates cycles of alertness and sleepiness by responding to light changes in our environment. ",
    "", 
    "References",
    "https://www.ncbi.nlm.nih.gov/books/NBK519507/",
    "https://houstonsleepsolutions.com/blog/the-statistics-of-sleep-apnea/",
    "", 
    "Known model limitations:",
    "This model produces continuous data over 24hrs, and would not typically be reportable in any sort of laboratory test.  Clinical tests of melatonin or cortisol would take discrete sample at a specific time.",
    "This model can be interected with another function (i.e. a line), to produce a sleep/wake cycle.  Additional information on how to do this is provided in the Wiki.",
    "This model me be useful in generating cyclical daily habits, such as taking medicaitons in the morning, exercising at certain times of the day, and so forth.  Please see the Wiki for additional details." 
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "conditional_transition": [
        {
          "transition": "Female",
          "condition": {
            "condition_type": "Gender",
            "gender": "F"
          }
        },
        {
          "transition": "Male",
          "condition": {
            "condition_type": "Gender",
            "gender": "M"
          }
        },
        {
          "transition": "Terminal"
        }
      ]
    },
    "Terminal": {
      "type": "Terminal"
    },
    "Female": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.20
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.20
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.20
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.20
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.20
        }
      ]
    },
    "Male": {
      "type": "Simple",
      "remarks": [
        "About one-in-five Americans use a smart watch or fitness tracker.  \n https://www.pewresearch.org/short-reads/2020/01/09/about-one-in-five-americans-use-a-smart-watch-or-fitness-tracker/"
      ],
      "distributed_transition": [
        {
          "transition": "Age_20-29",
          "distribution": 0.20
        },
        {
          "transition": "Age_30-39",
          "distribution": 0.20
        },
        {
          "transition": "Age_40-49",
          "distribution": 0.20
        },
        {
          "transition": "Age_50-59",
          "distribution": 0.20
        },
        {
          "transition": "Age_60-74",
          "distribution": 0.20
        }
      ]
    },
    "Age_20-29": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 20,
        "high": 29,
        "unit": "years"
      }
    },
    "Age_30-39": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 30,
        "high": 39,
        "unit": "years"
      }
    },
    "Age_40-49": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 40,
        "high": 49,
        "unit": "years"
      }
    },
    "Age_50-59": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 50,
        "high": 59,
        "unit": "years"
      }
    },
    "Age_60-74": {
      "type": "Delay",
      "direct_transition": "Sleep_Apnea",
      "range": {
        "low": 60,
        "high": 74,
        "unit": "years"
      }
    },


    "Sleep_Apnea": {
      "type": "ConditionOnset",
      "target_encounter": "SleepStudy_Baseline_Encounter",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 73430006,
          "display": "Sleep apnea (disorder)"
        }
      ],
      "remarks": [
        "More than 60% of US adults do not engage in recommended amount of physical activity.  25% of adults are not physically active at all.",
        "https://www.cdc.gov/nccdphp/sgr/adults.htm#:~:text=More%20than%2060%20percent%20of,Women%20than%20men."
      ],
      "distributed_transition": [
        {
          "transition": "SleepStudy_Baseline_Encounter",
          "distribution": 0.2
        },
        {
          "transition": "Symptom_Onset_Delay",
          "distribution": 0.79
        },
        {
          "transition": "Terminal",
          "distribution": 0.01
        }
      ]
    },
    "Symptom_Onset_Delay": {
      "type": "Delay",
      "direct_transition": "Insomia_Symptom",
      "range": {
        "low": 1,
        "high": 5,
        "unit": "years"
      }
    },
    "Insomia_Symptom": {
      "type": "Symptom",
      "symptom": "Insomnia",
      "cause": "Sleep_Apnea",
      "direct_transition": "Insomia_Symptom_Ends"
    },
    "Insomia_Symptom_Ends": {
      "type": "Symptom",
      "symptom": "Insomnia",
      "cause": "Sleep_Apnea",
      "direct_transition": "Physical_Activity_Resumes"
    },

    "Physical_Activity_Resumes": {
      "type": "ConditionEnd",
      "condition_onset": "Sleep_Apnea",
      "direct_transition": "Terminal"
    },

    "SleepStudy_Baseline_Encounter": {
      "type": "Encounter",
      "encounter_class": "emergency",
      "reason": "SleepStudy_Baseline",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "direct_transition": "Monitor_iWatch"
    },

    "Monitor_iWatch": {
      "type": "Device",
      "code": {
        "system": "SNOMED-CT",
        "code": 13288007,
        "display": "Monitor, device (physical object)"
      },
      "direct_transition": "SleepStudy_Baseline",
      "assign_to_attribute": "sleep_data_iwatch"
    },

    "SleepStudy_Baseline_Encounter_End": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal",
      "discharge_disposition": {
        "system": "NUBC",
        "code": "01",
        "display": "Discharged to home care or self care (routine discharge)"
      }
    },


    "SleepStudy_Baseline": {
      "type": "Procedure",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "duration": {
        "low": 5,
        "high": 10,
        "unit": "minutes"
      },
      "direct_transition": "SleepMonitor_Sim"
    },
    "SleepMonitor_Sim": {
      "type": "Physiology",
      "model": "Hong2009_CircadianClock.xml",
      "solver": "runge_kutta",
      "step_size": 0.01,
      "sim_duration": 24,
      "lead_time": 0,
      "inputs": [
        {
          "from_exp": "#{BMI}",
          "to": "kica"
        }
      ],
      "outputs": [
        {
          "from_list": "CPtot",
          "to": "sleep_monitor_data",
          "type": "Attribute"
        }
      ],
      "direct_transition": "SleepMonitor_Data",
      "alt_direct_transition": "SleepAnalysis"
    },
    "SleepMonitor_Data": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "sampled_data": {
        "attributes": [
          "sleep_monitor_data"
        ]
      },
      "direct_transition": "SleepMonitor_Chart"
    },
    "SleepMonitor_Chart": {
      "type": "Observation",
      "category": "procedure",
      "unit": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 60554003,
          "display": "Polysomnography (procedure)"
        }
      ],
      "attachment": {
        "chart": {
          "type": "line",
          "title": "Circadian Cycle",
          "axis_attribute_x": "time",
          "width": 400,
          "height": 200,
          "series": [
            {
              "attribute": "sleep_monitor_data"
            }
          ]
        }
      },
      "direct_transition": "Clear_SleepMonitor_result"
    },
    "Clear_SleepMonitor_result": {
      "type": "SetAttribute",
      "attribute": "sleep_monitor_data",
      "direct_transition": "SleepAnalysis"
    },
    "SleepAnalysis": {
      "type": "Observation",
      "category": "exam",
      "unit": "",
      "codes": [
        {
          "system" : "http://loinc.org",
          "code" : "93832-4",
          "display" : "Sleep duration."
        }
      ],
      "direct_transition": "SleepStudy_Baseline_Encounter_End"
    }
  },
  "gmf_version": 1
}